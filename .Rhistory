curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-40
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-20
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-5
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-20
v<-50
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4),main="5 grados de libertad")
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-50
v<-5
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4),main="5 grados de libertad")
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-50
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4),main="50 grados de libertad")
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
curve(dt(x,20))
curve(dt(x,20),xlim=c(-3,3))
curve(dt(x,20),xlim=c(-4,4))
1-pt(0.5,20)
1-pt(0,20)
pt(1,20)
pt(1,20)-pt(-1,20)
lm(rnorm(100)~rnorm(100))
lm(rnorm(100)~rnorm(100))
summary(lm(rnorm(100)~rnorm(100)))
anavoa(lm(rnorm(100)~rnorm(100)))
anova(lm(rnorm(100)~rnorm(100)))
anova(lm(rnorm(100)~rnorm(100,10)))
curve(df(x,10,10),xlim=c(0,6))
curve(df(x,15,10),xlim=c(0,6))
curve(df(x,100,100),xlim=c(0,6))
curve(df(x,1000,1000),xlim=c(0,6))
curve(df(x,30,30),xlim=c(0,6))
curve(df(x,10,10),xlim=c(0,6))
curve(df(x,15,10),xlim=c(0,6))
curve(df(x,100,100),xlim=c(0,6))
curve(df(x,1000,1000),xlim=c(0,6))
curve(df(x,30,30),xlim=c(0,6))
curve(df(x,10,10),xlim=c(0,6))
#P(X<t)=F(t), donde  X ~ F(v1,v2). F(10,10), P(X<1)=F(1)
pf(1,10,10)
pf(1,50,50)
pf(1,25,50)
pf(1,25,10)
pf(1,30,30)
pf(1,25,60)
pf(1,25,15)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
10*5
10*6
15*6
x<-c(20,20,25,28,30,26)
n<-3
N<-6
n<-3
choose(N,n)
combn(x,3)
combn(x,3)
s<-combn(x,3)
s
apply(s,2,mean)
xbar<-apply(s,2,mean)
mean(x)#mu
xbar
sum(xbar*1/20)
sum(xbar*1/20)
s
xbar<-apply(s,2,mean)
xbar
table(xbar)
mean(x)#mu
sum(xbar*1/20)#E[xbar]
s
xbar
xbar-mean(xbar)
(xbar-mean(xbar))^2
(1/20)*(xbar-mean(xbar))^2
sum((1/20)*(xbar-mean(xbar))^2)
sum((1/20)*(xbar-mean(xbar))^2)#V(xbar)
x
sum(((x-mean(x))^2)/(N-1))
s2<-sum(((x-mean(x))^2)/(N-1))
var(x)
s2<-var(x)
(1-n/N)*(s2/n)#formula
sum((1/20)*(xbar-mean(xbar))^2)#V(xbar)
sum((1/20)*(xbar-mean(xbar))^2)#V(xbar)
(1-n/N)*(s2/n)#formula
x<-c(20,20,25,28,30,26)
x<-c(20,20,25,28,30,26)
x<-c(20,20,25,28,30,26)
var(x)
mean(x)
comb(x,3)
combn(x,3)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
x<-c(5,12,6,9,10,6,6,4,8,10,5,12,6)
x
var(x)
sd(x)
(1.96*2.72/0.8)^2
(1.64*650/300)^2
x
mean(x)
sd(x)
n<-35
set.seed(1517)
x<-round(rnorm(n,7.6,2.72),0)
x
x
x
x
mean(x)
mean(x)
1.64*sqrt(var(x)/n)
mean(x)+c(-1,1)*1.64*sqrt(var(x)/n)
mean(x)+c(-1,1)*1.64*sqrt(var(x)/n)#90%
mean(x)+c(-1,1)*1.96*sqrt(var(x)/n)#95%
mean(x)+c(-1,1)*2.58*sqrt(var(x)/n)#99%
qnorm(0.05/2,lower.tail = F)
qnorm(0.05/2,lower.tail = T)
qnorm(0.05/2,lower.tail = F)
?qt()
#para la t-student
alpha<-0.05
n<-20
qt(alpha/2,n-1,lower.tail = F)
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
#para la t-student
alpha<-0.1
n<-20
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-0.01
n<-20
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-0.05
n<-20
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-0.05
n<-200
#para la t-student
alpha<-0.05
n<-200
qt(alpha/2,n-1,lower.tail = F)
n<-2000
qt(alpha/2,n-1,lower.tail = F)
n<-20000
qt(alpha/2,n-1,lower.tail = F)
n<-200000
qt(alpha/2,n-1,lower.tail = F)
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
n<-2000000
qt(alpha/2,n-1,lower.tail = F)
n<-20000000
qt(alpha/2,n-1,lower.tail = F)
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
n<-20000000
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
qt(alpha/2,n-1,lower.tail = F)
n<-31
qt(alpha/2,n-1,lower.tail = F)
n<-60
qt(alpha/2,n-1,lower.tail = F)
n<-100
qt(alpha/2,n-1,lower.tail = F)
n<-30
qt(alpha/2,n-1,lower.tail = F)
n<-30:100
qt(alpha/2,n-1,lower.tail = F)
n<-30:200
qt(alpha/2,n-1,lower.tail = F)
n<-30:300
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-c(0.1,0.05,0.01)
n<-20
qt(alpha/2,n-1,lower.tail = F)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
set.seed(1501)
x<-round(rnorm(15,165,10),0)
x
set.seed(1431)
x<-round(rnorm(15,165,10),0)
x
x
n<-15
x
x>=170
(x>=170)*1
(x>=170)*1
x<-(x>=170)*1
x
#el estimador de la proporción
p<-mean(x)
p
#en porcentaje
p*100
x
#intervalo
p+c(-1,1)*1.96*sqrt(p*(1-p)/n)
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
p
n<-100
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
1000
n<-1000
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
vp<-function(x){x*(1-x)}
curve(vp)
curve(vp,xlab="p")
curve(vp,xlab="p",ylab="v(p)",main="n=1")
n<-15
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
tm_p<-function(z,e,p){
n<-((z/e)^2)*(p*(1-p))
return(n)
}
tm_p(1.96,0.05,0.5)
ceiling(tm_p(1.96,0.05,0.5))
ceiling(tm_p(1.96,0.05,0.5))
ceiling(tm_p(1.96,0.05,0.5))
ceiling(tm_p(1.96,0.05,0.5))#1
ceiling(tm_p(1.96,0.05,0.7))#2
ceiling(tm_p(1.96,0.02,0.7))#epsilon 2%
ceiling(tm_p(1.96,0.02,0.5))#epsilon 2%
ceiling(tm_p(1.96,0.01,0.5))#epsilon 2%
ceiling(tm_p(1.96,0.01,0.5))#epsilon 1%
4.05+c(-1,1)*1.71*sqrt(0.08^2/25)
qt(0.1/2)
qt(0.1/2,24)
qt(0.1/2,24,lower.tail = T)
qt(0.1/2,24,lower.tail = F)
ta<-qt(0.1/2,24,lower.tail = F)
4.05+c(-1,1)*ta*sqrt(0.08^2/25)
ta
qt(0.1,24)
qt(0.1,24,lower.tail = F)
4.05+c(-1)*1.32*sqrt(0.08^2/25)
(1.96*0.45/0.25)^2
N<-10000
x<-abs(round(rnorm(N,2500,3000),0))
x
x
mean(x)
median(x)
mean(x)#parámetro de la media
median(x)#parámetro de la mediana
x
hist(x)
hist(x)
abline(mean(x),col="red")
abline(h=mean(x),col="red")
abline(v=mean(x),col="red")
abline(v=median(x),col="blue")
##################################
n<-40
set.seed(15:27)
s<-sample(x,n)
s
mean(x)
mean(s)
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
mean(s)#estimador puntual
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
#medidas de tendencia central
mean(x)#parámetro de la media
mean(s)#estimador puntual
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
hist(x)
abline(v=mean(x),col="red")
var(x)
var(x)*((N-1)/N)
var(x)*((N-1)/N)
sqrt(var(x)*((N-1)/N))
var(s)
var(x)*((N-1)/N)#parámetro
mean(s)+c(-1,1)*1.96*sqrt(sd(s)^2/n)#IC
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
rm(list=ls())
setwd("C:\\Users\\ALVARO\\Box\\ipm_fao_chiquitania\\_data\\_out")
library(haven)
bd<-read_dta("fao_v0.dta")
library(ggplot2)
ggplot(bd,aes(wt,col=s0_1))+geom_density()
ggplot(bd,aes(wt,col=factor(s0_1)))+geom_density()
ggplot(bd,aes(wt,col=factor(s0_1)))+geom_density()+facet_wrap(~estrato)
ggplot(bd,aes(wt,col=estrato))+geom_density()+facet_wrap(~s0_1)
ggplot(bd,aes(wt,col=factor(estrato)))+geom_density()+facet_wrap(~s0_1)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
load(url("https://github.com/AlvaroLimber/EST-383/raw/master/data/eh19.RData"))
library(dplyr)
eh19p$s02a_02
eh19p$s02a_03
eh19p<-eh19p %>% select(s02a_02,ylab) %>% na.omit()
eh19p
View(eh19p)
mean(eh19p$ylab)
load(url("https://github.com/AlvaroLimber/EST-383/raw/master/data/eh19.RData"))
eh19p<-eh19p %>% select(sexo=s02a_02,ylab) %>% na.omit()
eh19p %>% group_by(sexo) %>% summarise(mean(ylab))
3423-2558
#suponer que la selección fue aleatoria simple.
mean(eh19p$ylab)
eh19p %>% group_by(sexo) %>% summarise(mean(ylab))
3423-2558
mean(eh19p$ylab)
mean(eh19p$ylab)+c(-1,1)*1.96*sqrt(var(eh19p$ylab)/15789)
#varianza
eh19p %>% group_by(sexo) %>% summarise(mean(ylab))
#varianza
eh19p %>% group_by(sexo) %>% summarise(var(ylab))
6620627/4885401
#varianza
v1<-eh19p %>% group_by(sexo) %>% summarise(var(ylab))
v1
v1[1,2]
v1[1,2]/v1[2,2]
sample(30,1:15789)
sample(1:15789,25)
s<-sample(1:15789,25)
eh19p[s,]
s<-sample(1:15789,20)
eh19p[s,]
eh19p %>% filter(sexo=="1.Hombre")
eh19p[s,] %>% filter(sexo=="1.Hombre")
eh19p[s,] %>% filter(sexo=="1.Hombre") %>% select(ylab)
eh19p[s,] %>% filter(sexo=="1.Hombre") %>% select(ylab) %>% round(0)
s<-sample(1:15789,20)
eh19p[s,] %>% filter(sexo=="1.Hombre") %>% select(ylab) %>% round(0)
s<-sample(1:15789,30)
eh19p[s,] %>% filter(sexo=="1.Hombre") %>% select(ylab) %>% round(0)
set.seed(1500)
s<-sample(1:15789,30)
eh19p[s,] %>% filter(sexo=="1.Hombre") %>% select(ylab) %>% round(0)
eh19p[s,] %>% filter(sexo=="2.Mujer") %>% select(ylab) %>% round(0)
hh<-c(2078,  3565,  3767,  3600,  2907,  1299,  3483,  8475,  2425,  3500,  3118,  3377,  3897, 21883,  9717,  2078,  8167)
hh
mm<-c(1905, 9500, 996, 3250, 3335, 433, 2917, 616, 1625, 1104, 2050, 3000, 1625)
mm
nh<-17
nm<-13
nh<-17;nm<-13
#estimador de varianzas
var(hh)
var(mm)
#estimador de varianzas
var(hh)#puntual hombres
var(mm)#puntual mujeres
var(hh)*(nh-1)
(var(hh)*(nh-1))/
qchisq(0.05/2,nh-1)
qchisq(0.05/2,nh-1)
(var(hh)*(nh-1))/qchisq(0.05/2,nh-1)
qchisq(1-0.05/2,nh-1)
(var(hh)*(nh-1))/qchisq(0.05/2,nh-1)
(var(hh)*(nh-1))/qchisq(1-0.05/2,nh-1)
(var(hh)*(nh-1))/qchisq(0.05/2,nh-1)
(var(hh)*(nh-1))/qchisq(1-0.05/2,nh-1)
#estimador de varianzas
var(hh)#puntual hombres
lih<-(var(hh)*(nh-1))/qchisq(0.05/2,nh-1)
lsh<-(var(hh)*(nh-1))/qchisq(1-0.05/2,nh-1)
lih;var(hh);lsh
qchisq(0.95,19)
qchisq(0.95,19,lower.tail = T)
qchisq(0.95,19,lower.tail = F)
lih<-(var(hh)*(nh-1))/qchisq(0.05/2,nh-1)
lsh<-(var(hh)*(nh-1))/qchisq(1-0.05/2,nh-1,lower.tail = F)
lih;var(hh);lsh
lih<-(var(hh)*(nh-1))/qchisq(0.05/2,nh-1,lower.tail = F)
lsh<-(var(hh)*(nh-1))/qchisq(1-0.05/2,nh-1,lower.tail = F)
lih;var(hh);lsh
lsh<-(var(hh)*(nh-1))/qchisq(1-0.05/2,nh-1)
lsh
lih<-(var(hh)*(nh-1))/qchisq(0.05/2,nh-1,lower.tail = F)
lsh<-(var(hh)*(nh-1))/qchisq(1-0.05/2,nh-1,lower.tail = F)
lih;var(hh);lsh
#intervalo mujeres
limj<-(var(mm)*(nm-1))/qchisq(0.05/2,nm-1,lower.tail = F)
lsmj<-(var(mm)*(nm-1))/qchisq(1-0.05/2,nm-1,lower.tail = F)
limj;var(mm);lsmj
var(hh)/var(mm)
var(hh)/var(mm)*qf(1-0.05/2,nm-1,nh-1,lower.tail = F)
var(hh)/var(mm)*qf(0.05/2,nm-1,nh-1,lower.tail = F)
lihm<-var(hh)/var(mm)*qf(1-0.05/2,nm-1,nh-1,lower.tail = F)
lshm<-var(hh)/var(mm)*qf(0.05/2,nm-1,nh-1,lower.tail = F)
lihm; var(hh)/var(mm); lshm
lihm<-(var(hh)/var(mm))*qf(1-0.05/2,nm-1,nh-1,lower.tail = F)
lshm<-(var(hh)/var(mm))*qf(0.05/2,nm-1,nh-1,lower.tail = F)
lihm; var(hh)/var(mm); lshm
var(mm)/var(hh)#puntual
#intervalos
limh<-(var(mm)/var(hh))*qf(1-0.05/2,nh-1,nm-1,lower.tail = F)
lsmh<-(var(mm)/var(hh))*qf(0.05/2,nh-1,nm-1,lower.tail = F)
limh; var(mm)/var(hh); lsmh
v1
v1[1,2]/v1[2,2]
lihm; var(hh)/var(mm); lshm
#99 confiabilidad
lihm<-(var(hh)/var(mm))*qf(1-0.01/2,nm-1,nh-1,lower.tail = F)
lshm<-(var(hh)/var(mm))*qf(0.01/2,nm-1,nh-1,lower.tail = F)
lihm; var(hh)/var(mm); lshm
eh19p$ylab
plot(density(eh19p$ylab))
plot(density(eh19p$ylab))
v1[1,2]/v1[2,2]
table(eh19p$sexo)
v1[1,2]/v1[2,2]
(v1[1,2]*(9427/9428))/(v1[2,2]*(6360/6361))
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
x<-round(runif(30,40,80),0)
set.seed(1447)
x<-round(runif(30,40,80),0)
x
mean(x)
(60.5-65)/(10/sqrt(30))
curve(dnorm(x),xlim=c(-4,4),main="")
abline(v=(60.5-65)/(10/sqrt(30)),col="blue")
abline(v=c(-1.96,1.96),col="red")
abline(v=c(-1.64,1.64),col="red")
abline(v=c(-2.58,2.58),col="red")
text(c(-3.5,0,3.5),rep(0.2,3),c("Rechazo","Aceptación","Rechazo"))
mean(x)
sd(x)
sd(x);length(x)
sd(x);length(x);mean(x)
(60.5-65)/(11.057/sqrt(30))
qt(0.05/2,30-1,lower.tail = F)
qt(0.05/2,30-1,lower.tail = T)
qt(0.05/2,30-1,lower.tail = F)
qt(0.01/2,30-1,lower.tail = F)
qt(0.05/2,30-1,lower.tail = F)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
0.25*40
(10-40*0.3)/sqrt(40*0.3*0.7)
(0.25-0.3)/sqrt(0.3*0.7/40)
combn(1000,40)
choose(1000,40)
?power
sqrt(0.5*0.5)
qnorm(0.05/2,lower.tail = F)
qnorm(0.2,lower.tail = F)
qnorm(0.2,lower.tail = F)
zb<-qnorm(0.2,lower.tail = F)
za2<-qnorm(0.05/2,lower.tail = F)
zb<-qnorm(0.2,lower.tail = F)
n<-((za2*0.5+zb*0.5)/0.09)^2
n
((za2*0.5+zb*0.5)/0.4)^2
((za2*0.5+zb*0.5)/0.01)^2
((za2*0.5+zb*0.5)/0.05)^2
((za2*0.5+zb*0.5)/0.06)^2
((za2*0.5+zb*0.5)/0.04)^2
n<-((za2*0.5+zb*0.5)/0.09)^2
n
za2<-qnorm(0.05/2,lower.tail = F)
zb<-qnorm(0.05,lower.tail = F)
n<-((za2*0.5+zb*0.5)/0.09)^2
n
za2<-qnorm(0.05/2,lower.tail = F)
zb<-qnorm(0.01,lower.tail = F)
n<-((za2*0.5+zb*0.5)/0.09)^2
n
zb<-qnorm(0.2,lower.tail = F)
n<-((za2*0.5+zb*0.5)/0.09)^2
n
zb<-qnorm(0.1,lower.tail = F)
n<-((za2*0.5+zb*0.5)/0.09)^2
n
zb<-qnorm(0.2,lower.tail = F)
n<-((za2*0.5+zb*0.5)/0.09)^2
n
t.test(c(2,3,5,3,4),mu=4)
t.test(c(2,3,5,3,4),mu=4)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
