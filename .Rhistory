dmediana<-apply(s,2,median)
dmediana
s
dmedia
dmediana
# Son estimadores insesgados
#media
sum(dmedia*(1/10)) # E[]
mean(dmedia)
mean(x)
#media
sum(dmediana*(1/10)) # E[]
mean(dmediana)
mean(x)
x
mean(dmedia)
mean(dmediana)
median(x)
# Cuál estimador es más eficiente
sum((dmedia-mean(dmedia))^2*1/10) # media muestral
N<-5
x<-c(10,10,20,25,30)
x
mean(x)#parámetro
n<-3#muestra
choose(5,3)
s<-combn(x,3)
s
#distribución muestral de la media muestral
dmedia<-apply(s,2,mean)
dmedia
#distribución muestral de la mediana muestral
dmediana<-apply(s,2,median)
dmediana
# Son estimadores insesgados
#media
sum(dmedia*(1/10)) # E[]
mean(dmedia)
#media
sum(dmediana*(1/10)) # E[]
mean(dmediana)
#parámetro media poblacional
mean(x)
# Cuál estimador es más eficiente
sum((dmedia-mean(dmedia))^2*1/10) # media muestral
sum((dmediana-mean(dmediana))^2*1/10) # mediana muestral
curve(dnorm(x),xlim=c(-3.5,3.5),xlab="z")
abline(v=0)
sx<-c(-3.5,seq(-3.5,qnorm(0.025),0.01),qnorm(0.025))
sy<-c(0,dnorm(seq(-3.5,qnorm(0.025),0.01)),0)
polygon(sx,sy,col="red")
polygon(-1*sx,sy,col="red")
qnorm(0.05/2)
#para encontrar los z
qnorm(0.1/2)
qnorm(0.05/2)#5%
qnorm(0.01/2)#1%
#para encontrar los z_{1-alpha/2}
qnorm(1-0.1/2)#10%
qnorm(1-0.05/2)#5%
qnorm(1-0.01/2)#1%
x<-c(4, 6, 4, 4, 6, 5 , 8, 6, 2, 2)
x
sd(x)
(1.96*1.89/0.3)^2
((1.96*1.89)/0.3)^2
sqrt(var(x)(9/10))
sqrt(var(x)*(9/10))
((1.96*1.79)/0.3)^2
153/5000
153/60000
N<-200
n<-25
x<-runif(N,2,15)#gasto en pasaje
x
N<-200
n<-25
set.seed(123)
x<-runif(N,2,15)#gasto en pasaje
set.seed(123)
x<-runif(N,2,15)#gasto en pasaje
set.seed(123)
x<-round(runif(N,2,15),1)#gasto en pasaje
x
mean(x)
N<-200
n<-25
set.seed(123)
x<-round(runif(N,2,15),1)#gasto en pasaje
mean(x)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
sample(x,25)
# muestras
choose(25,200)
# muestras
choose(200,25)
sample(x,25)
sample(x,25)
sample(x,25)
sample(x,25)
s<-sample(x,25)
s
mean(s)
s<-sample(x,25)
mean(s)
s<-sample(x,25)
mean(s)
s<-sample(x,25)
mean(s)
s<-sample(x,25)
xbar<-mean(s)
x
sigma<-sqrt(var(x)(199/200))
sigma<-sqrt(var(x)*(199/200))
sigma
#IC 95%
xbar+c(-1,1)*1.96*sigma/sqrt(n)
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
xbar+c(-1,1)*1.96*sigma/sqrt(n)
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
xbar+c(-1,1)*1.96*sigma/sqrt(n)
mean(x)
plot(0,type="n",xlim=c(0,17),ylim(0,100))
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x))
abline(v=mean(x),col="red")
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
xbar+c(-1,1)*1.96*sigma/sqrt(n)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
point(ic,c(1,1),col="blue")
points(ic,c(1,1),col="blue")
mean(x)
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
points(ic,c(1,1),col="blue")
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
points(ic,c(i,i),col="blue")
}
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
segments(ic,c(i,i),col="blue")
}
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
points(ic,c(i,i),col="blue")
}
line
?line
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
line(ic,c(i,i),col="blue")
}
line(ic,c(i,i))
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
line(ic,c(i,i))
}
abline(ic,c(i,i))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
abline(ic,c(i,i))
}
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
points(ic,c(i,i))
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
points(ic,c(i,i))
}
points(ic,c(i,i),col="blue")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
points(ic,c(i,i),col="blue")
}
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
points(ic,c(i,i),col="blue")
}
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.64*sigma/sqrt(n)
points(ic,c(i,i),col="blue")
}
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
points(ic,c(i,i),col="blue")
}
?segments(ic,c(i,i),col="blue")
segments(ic[1],i,ic[2],i,col="blue")
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
segments(ic[1],i,ic[2],i,col="blue")
}
plot(0,type="n",xlim=c(0,17),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
segments(ic[1],i,ic[2],i,col="blue")
if(mean(x)>ic[2] | mean(x)<ic[1]){
segments(ic[1],i,ic[2],i,col="red")
}
}
plot(0,type="n",xlim=c(2,15),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
segments(ic[1],i,ic[2],i,col="blue")
if(mean(x)>ic[2] | mean(x)<ic[1]){
segments(ic[1],i,ic[2],i,col="red")
}
}
N<-200
n<-25
set.seed(123)
x<-round(runif(N,2,15),1)#gasto en pasaje
x
mean(x)
sigma<-sqrt(var(x)*(199/200))
# muestras
choose(200,25)
plot(0,type="n",xlim=c(2,15),ylim=c(0,100))
abline(v=mean(x),col="red")
mean(x)
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 95%
ic<-xbar+c(-1,1)*1.96*sigma/sqrt(n)
segments(ic[1],i,ic[2],i,col="blue")
if(mean(x)>ic[2] | mean(x)<ic[1]){
segments(ic[1],i,ic[2],i,col="red")
}
}
plot(0,type="n",xlim=c(2,15),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 90%
ic<-xbar+c(-1,1)*1.64*sigma/sqrt(n)
segments(ic[1],i,ic[2],i,col="blue")
if(mean(x)>ic[2] | mean(x)<ic[1]){
segments(ic[1],i,ic[2],i,col="red")
}
}
plot(0,type="n",xlim=c(2,15),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 99%
ic<-xbar+c(-1,1)*2.58*sigma/sqrt(n)
segments(ic[1],i,ic[2],i,col="blue")
if(mean(x)>ic[2] | mean(x)<ic[1]){
segments(ic[1],i,ic[2],i,col="red")
}
}
plot(0,type="n",xlim=c(2,15),ylim=c(0,100))
abline(v=mean(x),col="red")
for(i in 1:100){
s<-sample(x,25)
xbar<-mean(s)
#IC 99%
ic<-xbar+c(-1,1)*2.58*sigma/sqrt(n)
segments(ic[1],i,ic[2],i,col="blue")
if(mean(x)>ic[2] | mean(x)<ic[1]){
segments(ic[1],i,ic[2],i,col="red")
}
}
qnorm(0.5)
qnorm(0.5)
qnorm(0.005)
qnorm(0.1)
85.9+c(-1,1)*2.58*sqrt(1/18+1.5^2/16)
85.9+c(-1,1)*2.58*sqrt(1/18+1.5^2/16)
85.9+c(-1,1)*2.58*sqrt((1/18)+(1.5^2)/16)
(85.9-73.3)+c(-1,1)*2.58*sqrt((1/18)+(1.5^2)/16)
(85.9-73.3)+c(-1,1)*1.28*sqrt((1/18)+(1.5^2)/16)
18+c(-1,1)*1.64*sqrt(7^2/35)
18+c(-1,1)*1.64*sqrt(7^2/35)
490/35
14+c(-1,1)*1.64*sqrt(8.9^2/35)
qnorm(0.025)
qt(0.025,29)
qt(0.025,50)
qt(0.025,500)
qt(0.1/2,20-1)
qt(0.1/2,20-1,lower.tail = F)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
set.seed(1536)
set.seed(240)
bd<-data.frame(id=1:12,p1=round(runif(12,40,80)),p2=round(runif(12,30,90)))
bd
#estimador puntual
mean(bd$p1)
mean(bd$p2)
mean(bd$p2)-mean(bd$p1)
#creando la variable D=p2-p1
bd$D<-bd$p2-bd$p1
bd
mean(bd$D)+c(-1,1)*qt(0.1/2,11,lower.tail = F)*sqrt(var(bd$D)/12)
qt(0.1/2,11,lower.tail = F)
qt(0.1/2,11,lower.tail = F)
#############################
#suponer una muestra de 100 estudiantes
n<-100
set.seed(1536)
bd2<-data.frame(id=1:n,p1=round(runif(n,40,80)),p2=round(runif(n,30,90)))
bd2
bd
mean(bd$D)+c(-1,1)*qt(0.1/2,11,lower.tail = F)*sqrt(var(bd$D)/12)
bd2
#estimador puntual
mean(bd2$p1)
mean(bd2$p2)
mean(bd2$p2)-mean(bd2$p1)
#creando la variable D=p2-p1
bd2$D<-bd2$p2-bd2$p1
bd2
mean(bd2$D)+c(-1,1)*qnorm(0.1/2,lower.tail=F)*sqrt(var(bd2$D)/n)
10/30
(10/30)*100
(20/30)*100
33/60
0.55+c(-1,1)*1.96*sqrt(0.55*0.45/60)
0.55+c(-1,1)*1.96*sqrt(0.55*0.45/100)
0.55+c(-1,1)*1.96*sqrt(0.55*0.45/500)
0.55+c(-1,1)*1.96*sqrt(0.55*0.45/1000)
((1.96/0.05)^2)*(0.5^2)
tm_p<-function(z,e,p){
n<-((z/e)^2)*(p*(1-p))
return(n)
}
tm_p(1.96,0.05,0.5)
plot(p,tm_p(1.96,0.05,p))
tm_p<-function(z,e,p){
n<-((z/e)^2)*(p*(1-p))
return(n)
}
tm_p(1.96,0.05,0.5)
plot(p,tm_p(1.96,0.05,p))
p<-seq(0,1,0.01)
plot(p,tm_p(1.96,0.05,p))
5/45
((27/45)-(22/45))
1.96*sqrt(((27/45)*(1-27/45)/45)+((22/45)*(1-22/45)/45))
5/11+c(-1,1)*0.2045
(5/11)+c(-1,1)*0.2045
(5/45)+c(-1,1)*0.2045
round(runif(10,0,10),0)
round(runif(10,2,12),0)
?qnorm()
pnorm(0.05)
qnorm(0.025)
qchisq(0.95,19)
qchisq(0.95,19,lower.tail = F)
x<-scan()
x
mean(x)
var(x)
9*6.28
qchisq(0.05/2,9,lower.tail = F)
qchisq(1-0.05/2,9,lower.tail = F)
56.52/19.02
56.52/2.7
qf(1-0.05/2,14,14,lower.tail = F)
qf(0.05/2,14,14,lower.tail = F)
qf(1-0.05/2,12,12,lower.tail = F)
qf(0.05/2,12,12,lower.tail = F)
qf(1-0.05/2,12,12,lower.tail = F)
curve(dnorm(x),xlim=c(-4,4),main="significancia del 10%")
#
abline(v=c(-1.64,1.64),col="red")
text(c(-3.5,0,3.5),rep(0.2,3),c("Rechazo","Aceptación","Rechazo"))
# al 5 %
curve(dnorm(x),xlim=c(-4,4),main="significancia del 5%")
abline(v=c(-1.96,1.96),col="red")
text(c(-3.5,0,3.5),rep(0.2,3),c("Rechazo","Aceptación","Rechazo"))
# al 1 %
curve(dnorm(x),xlim=c(-4,4),main="significancia del 1%")
abline(v=c(-2.58,2.58),col="red")
text(c(-3.5,0,3.5),rep(0.2,3),c("Rechazo","Aceptación","Rechazo"))
x<-scan()
x<-scan()
x
mean(x)
# al 5 %
curve(dnorm(x),xlim=c(-4,4),main="significancia del 5%")
abline(v=c(-1.96,1.96),col="red")
text(c(-3.5,0,3.5),rep(0.2,3),c("Rechazo","Aceptación","Rechazo"))
abline(v=0.48,col="blue",lty=2)
(2.9-3.2)/(0.4/sqrt(35))
curve(dnorm(x),xlim=c(-4,4),main="Ejercicio")
curve(dnorm(x),xlim=c(-5,5),main="Ejercicio")
abline(v=c(-1.96,1.96),col="red")
abline(v=c(-2.58,2.58),col="darkred")
abline(v=c(-2.58,2.58),col="darkgreen")
text(c(-3.5,0,3.5),rep(0.2,3),c("Rechazo","Aceptación","Rechazo"))
abline(v=-4.43,col="blue",lty=2)
?qnorm()
pnorm(-4.43)
pnorm(-4.43)# pvalor
par(mfrow=c(1,2))
curve(dnorm(x),xlim=c(-4,4),main="HA: u>u0")
abline(v=c(1.28,1.64,2.33),col="red")
text(c(-2,3),c(0.3,0.3),c("Aceptación","Rechazo"))
text(c(1.28,1.64,2.33),rep(0.35,3),paste0(c(10,5,1),"%"),cex=0.7,col="blue")
curve(dnorm(x),xlim=c(-4,4),main="HA: u<u0")
abline(v=-c(1.28,1.64,2.33),col="red")
text(c(2,-3),c(0.3,0.3),c("Aceptación","Rechazo"))
text(-c(2.33,1.64,1.28),rep(0.35,3),paste0(c(1,5,10),"%"),cex=0.7,col="blue")
(2.9-3.2)/(0.4/sqrt(35))
x<-c(5,7,7,5,6,9,4)
x
mean(x)
sd(x)
sd(x)/sqrt(7)
(6.15-7)/0.63
(6.14-7)/0.63
(mean(x)-7)/(sd(x)/sqrt(7))
(69-73)/sqrt((7^2/40)+(6.8^2/40))
59/120
(0.4917-0.5)/sqrt(0.5^2/120)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
