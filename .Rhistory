choose(1000,60)
N<-1000
set.seed(1527)
x<-round(rnorm(N,60,10),0)
mean(x)#mu
sum((x-mean(x))^2)/N#sigma
n<-60
theta1<-NULL
theta2<-NULL
r<-2000
for(i in 1:r){
aux<-sample(x,n)
theta1[i]<-var(x)*((n-1)/n)
theta2[i]<-var(x)
}
theta1
theta1<-NULL
theta2<-NULL
r<-2000
for(i in 1:r){
aux<-sample(x,n)
theta1[i]<-var(aux)*((n-1)/n)
theta2[i]<-var(aux)
}
theta1
theta2
plot(density(theta1),col="red")
points(density(theta2),col="blue",type="l")
plot(density(theta1),col="red")
points(density(theta2),col="blue",type="l")
var(x)*((N-1)/N)
abline(v=var(x)*((N-1)/N))
plot(density(theta1),xlim=c(-50,300))
plot(density(theta1),col="red")
points(density(theta2),col="blue",type="l")
plot(density(theta1),col="red")
abline(v=var(x)*((N-1)/N)
abline(v=var(x)*((N-1)/N))
plot(density(theta1),col="red")
abline(v=var(x)*((N-1)/N))
points(density(theta2),col="blue",type="l")
mean(theta1)
mean(theta2)
var(x)*((N-1)/N)
var(x)*((N-1)/N)#parámetro
var(x)*((N-1)/N)#parámetro
mean(theta1)#estimador por copia /n
mean(theta2)#varianza muestral /n-1
n<-60
theta1<-NULL
theta2<-NULL
r<-5000
for(i in 1:r){
aux<-sample(x,n)
theta1[i]<-var(aux)*((n-1)/n)
theta2[i]<-var(aux)
}
plot(density(theta1),col="red")
points(density(theta2),col="blue",type="l")
abline(v=var(x)*((N-1)/N))
var(x)*((N-1)/N)#parámetro
mean(theta1)#estimador por copia /n
mean(theta2)#varianza muestral /n-1
r<-10000
for(i in 1:r){
aux<-sample(x,n)
theta1[i]<-var(aux)*((n-1)/n)
theta2[i]<-var(aux)
}
theta1<-NULL
theta2<-NULL
r<-10000
for(i in 1:r){
aux<-sample(x,n)
theta1[i]<-var(aux)*((n-1)/n)
theta2[i]<-var(aux)
}
plot(density(theta1),col="red")
points(density(theta2),col="blue",type="l")
abline(v=var(x)*((N-1)/N))
var(x)*((N-1)/N)#parámetro
mean(theta1)#estimador por copia /n
mean(theta2)#varianza muestral /n-1
n<-60
theta1<-NULL
theta2<-NULL
r<-20000
for(i in 1:r){
aux<-sample(x,n)
theta1[i]<-var(aux)*((n-1)/n)
theta2[i]<-var(aux)
}
plot(density(theta1),col="red")
points(density(theta2),col="blue",type="l")
abline(v=var(x)*((N-1)/N))
var(x)*((N-1)/N)#parámetro
mean(theta1)#estimador por copia /n
mean(theta2)#varianza muestral /n-1
abline(v=mean(theta1),col="red")
abline(v=mean(theta2),col="blue")
plot(density(theta1),col="red")
points(density(theta2),col="blue",type="l")
abline(v=var(x)*((N-1)/N))
abline(v=mean(theta1),col="red")
abline(v=mean(theta2),col="blue")
plot(density(x))
plot(density(x))
curve(dnorm)
curve(dnorm,xlim=c(-5,5))
theta1
theta2
n
sigma2x<-var(x)*((N-1)/N)#parámetro
(theta2*(n-1))/sigma2x
chi2<-(theta2*(n-1))/sigma2x
plot(density(chi2))
plot(density(chi2))
points(density(rchisq(1000000,59)),col="red",type="l")
curve(dchisq(df=59),add=T)
curve(dchisq(x,df=59),add=T)
plot(density(chi2))
curve(dchisq(x,df=59),add=T,col="red")
plot(density(chi2))
curve(dchisq(x,df=59),add=T,col="red")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
curve(dchisq(x,1),xlim=c(0,40),ylim=c(0,0.4))
curve(dchisq(x,1),xlim=c(0,40),ylim=c(0,0.4))
curve(dchisq(x,1),xlim=c(0,40),ylim=c(0,0.4))
curve(dchisq(x,2),xlim=c(0,40),ylim=c(0,0.4))
curve(dchisq(x,3),xlim=c(0,40),ylim=c(0,0.4))
curve(dchisq(x,4),xlim=c(0,40),ylim=c(0,0.4))
curve(dchisq(x,5),xlim=c(0,40),ylim=c(0,0.4))
curve(dchisq(x,1),xlim=c(0,40),ylim=c(0,0.4))
for(v in 2:30){
curve(dchisq(x,v),add=T,col=v)
}
curve(dchisq(x,1),xlim=c(0,60),ylim=c(0,0.4))
for(v in 2:50){
curve(dchisq(x,v),add=T,col=v)
}
curve(dchisq(x,10),xlim=c(0,60),ylim=c(0,0.4))
curve(dchisq(x,10),xlim=c(0,60))
abline(v=10)
abline(v=9)
curve(dchisq(x,10),xlim=c(0,60))
abline(v=10)
curve(dchisq(x,10),xlim=c(0,60),ylim=c(0,0.4))
for(v in 2:50){
curve(dchisq(x,v),add=T,col=v)
}
curve(dchisq(x,100),xlim=c(0,60))
curve(dchisq(x,100),xlim=c(0,200))
curve(dchisq(x,100),xlim=c(60,200))
curve(dchisq(x,10),xlim=c(0,60))
abline(v=10)
29*12/16
29*18/16
curve(dchisq(x,29))
curve(dchisq(x,29),xlim = c(0,60))
abline(v=c(21.75,32.635))
pchisq(32.635,29)
pchisq(21.75,29)
pchisq(32.635,29)-pchisq(21.75,29)
v<-5
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,5),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-10
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,5),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-5
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,5),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-20
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,5),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-30
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,5),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-100
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,5),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-100
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-20
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-30
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-40
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-20
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-5
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-20
v<-50
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4))
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4),main="5 grados de libertad")
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-50
v<-5
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4),main="5 grados de libertad")
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
v<-50
curve(dnorm(x,0,sqrt(v/(v-2))),xlim=c(-5,5),ylim=c(0,0.4),main="50 grados de libertad")
curve(dt(x,v),xlim=c(-5,5),main="t-student (v=10)",col="red",add=T)
curve(dt(x,20))
curve(dt(x,20),xlim=c(-3,3))
curve(dt(x,20),xlim=c(-4,4))
1-pt(0.5,20)
1-pt(0,20)
pt(1,20)
pt(1,20)-pt(-1,20)
lm(rnorm(100)~rnorm(100))
lm(rnorm(100)~rnorm(100))
summary(lm(rnorm(100)~rnorm(100)))
anavoa(lm(rnorm(100)~rnorm(100)))
anova(lm(rnorm(100)~rnorm(100)))
anova(lm(rnorm(100)~rnorm(100,10)))
curve(df(x,10,10),xlim=c(0,6))
curve(df(x,15,10),xlim=c(0,6))
curve(df(x,100,100),xlim=c(0,6))
curve(df(x,1000,1000),xlim=c(0,6))
curve(df(x,30,30),xlim=c(0,6))
curve(df(x,10,10),xlim=c(0,6))
curve(df(x,15,10),xlim=c(0,6))
curve(df(x,100,100),xlim=c(0,6))
curve(df(x,1000,1000),xlim=c(0,6))
curve(df(x,30,30),xlim=c(0,6))
curve(df(x,10,10),xlim=c(0,6))
#P(X<t)=F(t), donde  X ~ F(v1,v2). F(10,10), P(X<1)=F(1)
pf(1,10,10)
pf(1,50,50)
pf(1,25,50)
pf(1,25,10)
pf(1,30,30)
pf(1,25,60)
pf(1,25,15)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
10*5
10*6
15*6
x<-c(20,20,25,28,30,26)
n<-3
N<-6
n<-3
choose(N,n)
combn(x,3)
combn(x,3)
s<-combn(x,3)
s
apply(s,2,mean)
xbar<-apply(s,2,mean)
mean(x)#mu
xbar
sum(xbar*1/20)
sum(xbar*1/20)
s
xbar<-apply(s,2,mean)
xbar
table(xbar)
mean(x)#mu
sum(xbar*1/20)#E[xbar]
s
xbar
xbar-mean(xbar)
(xbar-mean(xbar))^2
(1/20)*(xbar-mean(xbar))^2
sum((1/20)*(xbar-mean(xbar))^2)
sum((1/20)*(xbar-mean(xbar))^2)#V(xbar)
x
sum(((x-mean(x))^2)/(N-1))
s2<-sum(((x-mean(x))^2)/(N-1))
var(x)
s2<-var(x)
(1-n/N)*(s2/n)#formula
sum((1/20)*(xbar-mean(xbar))^2)#V(xbar)
sum((1/20)*(xbar-mean(xbar))^2)#V(xbar)
(1-n/N)*(s2/n)#formula
x<-c(20,20,25,28,30,26)
x<-c(20,20,25,28,30,26)
x<-c(20,20,25,28,30,26)
var(x)
mean(x)
comb(x,3)
combn(x,3)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
x<-c(5,12,6,9,10,6,6,4,8,10,5,12,6)
x
var(x)
sd(x)
(1.96*2.72/0.8)^2
(1.64*650/300)^2
x
mean(x)
sd(x)
n<-35
set.seed(1517)
x<-round(rnorm(n,7.6,2.72),0)
x
x
x
x
mean(x)
mean(x)
1.64*sqrt(var(x)/n)
mean(x)+c(-1,1)*1.64*sqrt(var(x)/n)
mean(x)+c(-1,1)*1.64*sqrt(var(x)/n)#90%
mean(x)+c(-1,1)*1.96*sqrt(var(x)/n)#95%
mean(x)+c(-1,1)*2.58*sqrt(var(x)/n)#99%
qnorm(0.05/2,lower.tail = F)
qnorm(0.05/2,lower.tail = T)
qnorm(0.05/2,lower.tail = F)
?qt()
#para la t-student
alpha<-0.05
n<-20
qt(alpha/2,n-1,lower.tail = F)
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
#para la t-student
alpha<-0.1
n<-20
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-0.01
n<-20
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-0.05
n<-20
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-0.05
n<-200
#para la t-student
alpha<-0.05
n<-200
qt(alpha/2,n-1,lower.tail = F)
n<-2000
qt(alpha/2,n-1,lower.tail = F)
n<-20000
qt(alpha/2,n-1,lower.tail = F)
n<-200000
qt(alpha/2,n-1,lower.tail = F)
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
n<-2000000
qt(alpha/2,n-1,lower.tail = F)
n<-20000000
qt(alpha/2,n-1,lower.tail = F)
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
n<-20000000
qnorm(0.05/2,lower.tail = F)#PARA LA NORMAL
qt(alpha/2,n-1,lower.tail = F)
n<-31
qt(alpha/2,n-1,lower.tail = F)
n<-60
qt(alpha/2,n-1,lower.tail = F)
n<-100
qt(alpha/2,n-1,lower.tail = F)
n<-30
qt(alpha/2,n-1,lower.tail = F)
n<-30:100
qt(alpha/2,n-1,lower.tail = F)
n<-30:200
qt(alpha/2,n-1,lower.tail = F)
n<-30:300
qt(alpha/2,n-1,lower.tail = F)
#para la t-student
alpha<-c(0.1,0.05,0.01)
n<-20
qt(alpha/2,n-1,lower.tail = F)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
set.seed(1501)
x<-round(rnorm(15,165,10),0)
x
set.seed(1431)
x<-round(rnorm(15,165,10),0)
x
x
n<-15
x
x>=170
(x>=170)*1
(x>=170)*1
x<-(x>=170)*1
x
#el estimador de la proporción
p<-mean(x)
p
#en porcentaje
p*100
x
#intervalo
p+c(-1,1)*1.96*sqrt(p*(1-p)/n)
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
p
n<-100
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
1000
n<-1000
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
vp<-function(x){x*(1-x)}
curve(vp)
curve(vp,xlab="p")
curve(vp,xlab="p",ylab="v(p)",main="n=1")
n<-15
#intervalo en %
(p+c(-1,1)*1.96*sqrt(p*(1-p)/n))*100
tm_p<-function(z,e,p){
n<-((z/e)^2)*(p*(1-p))
return(n)
}
tm_p(1.96,0.05,0.5)
ceiling(tm_p(1.96,0.05,0.5))
ceiling(tm_p(1.96,0.05,0.5))
ceiling(tm_p(1.96,0.05,0.5))
ceiling(tm_p(1.96,0.05,0.5))#1
ceiling(tm_p(1.96,0.05,0.7))#2
ceiling(tm_p(1.96,0.02,0.7))#epsilon 2%
ceiling(tm_p(1.96,0.02,0.5))#epsilon 2%
ceiling(tm_p(1.96,0.01,0.5))#epsilon 2%
ceiling(tm_p(1.96,0.01,0.5))#epsilon 1%
4.05+c(-1,1)*1.71*sqrt(0.08^2/25)
qt(0.1/2)
qt(0.1/2,24)
qt(0.1/2,24,lower.tail = T)
qt(0.1/2,24,lower.tail = F)
ta<-qt(0.1/2,24,lower.tail = F)
4.05+c(-1,1)*ta*sqrt(0.08^2/25)
ta
qt(0.1,24)
qt(0.1,24,lower.tail = F)
4.05+c(-1)*1.32*sqrt(0.08^2/25)
(1.96*0.45/0.25)^2
N<-10000
x<-abs(round(rnorm(N,2500,3000),0))
x
x
mean(x)
median(x)
mean(x)#parámetro de la media
median(x)#parámetro de la mediana
x
hist(x)
hist(x)
abline(mean(x),col="red")
abline(h=mean(x),col="red")
abline(v=mean(x),col="red")
abline(v=median(x),col="blue")
##################################
n<-40
set.seed(15:27)
s<-sample(x,n)
s
mean(x)
mean(s)
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
mean(s)#estimador puntual
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
#medidas de tendencia central
mean(x)#parámetro de la media
mean(s)#estimador puntual
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
hist(x)
abline(v=mean(x),col="red")
var(x)
var(x)*((N-1)/N)
var(x)*((N-1)/N)
sqrt(var(x)*((N-1)/N))
var(s)
var(x)*((N-1)/N)#parámetro
mean(s)+c(-1,1)*1.96*sqrt(sd(s)^2/n)#IC
mean(s)+c(-1,1)*1.96*sqrt(var(s)/n)#IC
rm(list=ls())
setwd("C:\\Users\\ALVARO\\Box\\ipm_fao_chiquitania\\_data\\_out")
library(haven)
bd<-read_dta("fao_v0.dta")
library(ggplot2)
ggplot(bd,aes(wt,col=s0_1))+geom_density()
ggplot(bd,aes(wt,col=factor(s0_1)))+geom_density()
ggplot(bd,aes(wt,col=factor(s0_1)))+geom_density()+facet_wrap(~estrato)
ggplot(bd,aes(wt,col=estrato))+geom_density()+facet_wrap(~s0_1)
ggplot(bd,aes(wt,col=factor(estrato)))+geom_density()+facet_wrap(~s0_1)
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::clean_book(TRUE)
bookdown::render_book("index.Rmd", "bookdown::gitbook")
